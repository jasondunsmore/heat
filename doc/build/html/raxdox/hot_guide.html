<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Heat Orchestration Template (HOT) Guide &mdash; Supported Resources</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2015.2.dev78',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="Supported Resources" href="../index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li><a href="index.html">Supported Resources</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="heat-orchestration-template-hot-guide">
<span id="rax-hot-guide"></span><h1>Heat Orchestration Template (HOT) Guide<a class="headerlink" href="#heat-orchestration-template-hot-guide" title="Permalink to this headline">¶</a></h1>
<p>HOT is a new template format meant to replace the Heat CloudFormation-compatible
format (CFN) as the native format supported by the Heat over time.
This guide is targeted towards template authors and explains how to write
HOT templates based on examples. A detailed specification of HOT can be found
at <a class="reference internal" href="hot_spec.html#rax-hot-spec"><em>Heat Orchestration Template (HOT) Specification</em></a>.</p>
<div class="section" id="what-is-a-template">
<h2>What is a Template?<a class="headerlink" href="#what-is-a-template" title="Permalink to this headline">¶</a></h2>
<p>A Cloud Orchestration template is a portable file that describes how to
configure a set of resources and install the appropriate applications. It
describes the best practices for a particular type of deployment.</p>
<p>The template author (Cloud Orchestration architect) makes decisions about the
resources required for a deployment and describes how the resources should be
configured using YAML or JSON. In the template, the author defines several
important pieces of information that drive the installation, such as
parameters, resources, and relationships among the resources.</p>
<p>Once you have created a template, you can check it into your local github
repository if desired. If you would rather not start from scratch, browse the
OpenStack github repository (<a class="reference external" href="https://github.com/openstack/heat-templates">https://github.com/openstack/heat-templates</a>) or
Cloud Orchestration github repository
(<a class="reference external" href="https://github.com/rackspace-orchestration-templates">https://github.com/rackspace-orchestration-templates</a>) for a template that
closely matches your needs, clone it to a local repository, and then modify it
for your unique architecture.</p>
</div>
<div class="section" id="writing-a-hello-world-hot-template">
<h2>Writing a hello world HOT template<a class="headerlink" href="#writing-a-hello-world-hot-template" title="Permalink to this headline">¶</a></h2>
<p>This section gives an introduction on how to write HOT templates, starting from
very basic steps and then going into more and more detail by means of examples.</p>
<div class="section" id="a-most-basic-template">
<h3>A most basic template<a class="headerlink" href="#a-most-basic-template" title="Permalink to this headline">¶</a></h3>
<p>The most basic template you can think of may contain only a single resource
definition using only predefined properties (along with the mandatory Heat
template version tag). For example, the template below could be used to simply
deploy a single compute instance.</p>
<div class="highlight-python"><div class="highlight"><pre>heat_template_version: 2014-10-16

description: Simple template to deploy a single compute instance

resources:
  my_instance:
    type: OS::Nova::Server
    properties:
      key_name: my_key
      image: Ubuntu 14.04 LTS (Trusty Tahr) (PVHVM)
      flavor: 1 GB General Purpose v1
</pre></div>
</div>
<p>Each HOT template has to include the <em>heat_template_version</em> key with value
&#8216;2014-10-16&#8217; (the current version of HOT). While the <em>description</em> is optional,
it is good practice to include some useful text that describes what users can do
with the template. In case you want to provide a longer description that does
not fit on a single line, you can provide multi-line text in YAML, for example:</p>
<div class="highlight-python"><div class="highlight"><pre>description: |
  This is how you can provide a longer description
  of your template that goes over several lines.
</pre></div>
</div>
<p>The <em>resources</em> section is required and must contain at least one resource
definition. In the example above, a compute instance is defined with fixed
values for the &#8216;key_name&#8217;, &#8216;image&#8217; and &#8216;flavor&#8217; parameters.</p>
<p>Note that all those elements, i.e. a key-pair with the given name, the image and
the flavor have to exist in the OpenStack environment where the template is
used. Typically a template is made more easily reusable, though, by defining a
set of <em>input parameters</em> instead of hard-coding such values.</p>
</div>
<div class="section" id="template-input-parameters">
<h3>Template input parameters<a class="headerlink" href="#template-input-parameters" title="Permalink to this headline">¶</a></h3>
<p>Input parameters defined in the <em>parameters</em> section of a HOT template (see also
<a class="reference internal" href="hot_spec.html#rax-hot-spec-parameters"><em>Parameters Section</em></a>) allow users to customize a template during
deployment. For example, this allows for providing custom key-pair names or
image IDs to be used for a deployment.
From a template author&#8217;s perspective, this helps to make a template more easily
reusable by avoiding hard-coded assumptions.</p>
<p>Sticking to the example used above, it makes sense to allow users to provide
their custom key-pairs, provide their own image, and to select a flavor for the
compute instance. This can be achieved by extending the initial template as
follows:</p>
<div class="highlight-python"><div class="highlight"><pre>heat_template_version: 2014-10-16

description: Simple template to deploy a single compute instance

parameters:
  key_name:
    type: string
    label: Key Name
    description: Name of key-pair to be used for compute instance
  image_id:
    type: string
    label: Image ID
    description: Image to be used for compute instance
  instance_type:
    type: string
    label: Instance Type
    description: Type of instance (flavor) to be used

resources:
  my_instance:
    type: OS::Nova::Server
    properties:
      key_name: { get_param: key_name }
      image: { get_param: image_id }
      flavor: { get_param: instance_type }
</pre></div>
</div>
<p>In the example above, three input parameters have been defined that have to be
provided by the user upon deployment. The fixed values for the respective
resource properties have been replaced by references to the corresponding
input parameters by means of the <em>get_param</em> function (see also
<a class="reference internal" href="functions.html#rax-hot-functions"><em>Intrinsic Functions</em></a>).</p>
<p>You can also define default values for input parameters which will be used in
case the user does not provide the respective parameter during deployment. For
example, the following definition for the <em>instance_type</em> parameter would select
the &#8216;1 GB General Purpose v1&#8217; flavor unless specified otherwise by the user.</p>
<div class="highlight-python"><div class="highlight"><pre>parameters:
  instance_type:
    type: string
    label: Instance Type
    description: Type of instance (flavor) to be used
    default: 1 GB General Purpose v1
</pre></div>
</div>
<p>Another option that can be specified for a parameter is to hide its value when
users request information about a stack deployed from a template. This is
achieved by the <em>hidden</em> attribute and useful, for example when requesting
passwords as user input:</p>
<div class="highlight-python"><div class="highlight"><pre>parameters:
  database_password:
    type: string
    label: Database Password
    description: Password to be used for database
    hidden: true
</pre></div>
</div>
<div class="section" id="restricting-user-input">
<h4>Restricting user input<a class="headerlink" href="#restricting-user-input" title="Permalink to this headline">¶</a></h4>
<p>In some cases you might want to restrict the values of input parameters that
users can supply. For example, you might know that the software running in a
compute instance needs a certain amount of resources so you might want to
restrict the <em>instance_type</em> parameter introduced above. Parameters in HOT
templates can be restricted by adding a <em>constraints</em> section (see also
<a class="reference internal" href="hot_spec.html#rax-hot-spec-parameters-constraints"><em>Parameter Constraints</em></a>).
For example, the following would allow only three values to be provided as input
for the <em>instance_type</em> parameter:</p>
<div class="highlight-python"><div class="highlight"><pre>parameters:
  instance_type:
    type: string
    label: Instance Type
    description: Type of instance (flavor) to be used
    constraints:
      - allowed_values: [ 2 GB General Purpose v1, 4 GB General Purpose v1, 8 GB General Purpose v1 ]
        description: Value must be one of 2 GB General Purpose v1, 4 GB General Purpose v1, 8 GB General Purpose v1.
</pre></div>
</div>
<p>The <em>constraints</em> section allows for defining a list of constraints that must
all be fulfilled by user input. For example, the following list of constraints
could be used to clearly specify format requirements on a password to be
provided by users:</p>
<div class="highlight-python"><div class="highlight"><pre>parameters:
  database_password:
    type: string
    label: Database Password
    description: Password to be used for database
    hidden: true
    constraints:
      - length: { min: 6, max: 8 }
        description: Password length must be between 6 and 8 characters.
      - allowed_pattern: &quot;[a-zA-Z0-9]+&quot;
        description: Password must consist of characters and numbers only.
      - allowed_pattern: &quot;[A-Z]+[a-zA-Z0-9]*&quot;
        description: Password must start with an uppercase character.
</pre></div>
</div>
<p>Note that you can define multiple constraints of the same type. Especially in
the case of allowed patterns this not only allows for keeping regular
expressions simple and maintainable, but also for keeping error messages to be
presented to users precise.</p>
</div>
</div>
<div class="section" id="providing-template-outputs">
<h3>Providing template outputs<a class="headerlink" href="#providing-template-outputs" title="Permalink to this headline">¶</a></h3>
<p>In addition to template customization through input parameters, you will
typically want to provide outputs to users, which can be done in the
<em>outputs</em> section of a template (see also <a class="reference internal" href="hot_spec.html#rax-hot-spec-outputs"><em>Outputs Section</em></a>).
For example, the IP address by which the instance defined in the example
above can be accessed should be provided to users. Otherwise, users would have
to look it up themselves. The definition for providing the IP address of the
compute instance as an output is shown in the following snippet:</p>
<div class="highlight-python"><div class="highlight"><pre>outputs:
  instance_ip:
    description: The IP address of the deployed instance
    value: { get_attr: [my_instance, networks, public, 0] }
</pre></div>
</div>
<p>Output values are typically resolved using intrinsic function such as
the <em>get_attr</em> function in the example above (see also
<a class="reference internal" href="functions.html#rax-hot-functions"><em>Intrinsic Functions</em></a>).</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Heat Orchestration Template (HOT) Guide</a><ul>
<li><a class="reference internal" href="#what-is-a-template">What is a Template?</a></li>
<li><a class="reference internal" href="#writing-a-hello-world-hot-template">Writing a hello world HOT template</a><ul>
<li><a class="reference internal" href="#a-most-basic-template">A most basic template</a></li>
<li><a class="reference internal" href="#template-input-parameters">Template input parameters</a><ul>
<li><a class="reference internal" href="#restricting-user-input">Restricting user input</a></li>
</ul>
</li>
<li><a class="reference internal" href="#providing-template-outputs">Providing template outputs</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/raxdox/hot_guide.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li><a href="index.html">Supported Resources</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012,2015 Rackspace.
      Last updated on Mon Apr 13 21:08:05 2015, commit 58cb011.
    </div>
  </body>
</html>